University: [ITMO University](https://itmo.ru/ru/)

Faculty: [FTMI](https://ftmi.itmo.ru)

Course: [Cloud platforms as the basis of technology entrepreneurship](https://itmo-ict-faculty.github.io/cloud-platforms-as-the-basis-of-technology-entrepreneurship/education/labs2023-2024/lab1/lab1/#_2)

Year: 2025/2026

Group: HBM

Author: Kireev Mikhail Igorevich

Lab: Lab2

Date of create: 22.04.2025

Date of finished: 28.04.2025

# Лабораторная работа 2

## Цель работы
Познакомиться с развертыванием сервисов в Google Cloud Run, анализировать их поведение через метрики и логи при изменении настроек, научиться работать с версиями сервиса и управлением трафиком.

## Ход работы

### 1. Создание сервиса

- Был создан сервис в Cloud Run на основе стандартного приложения Hello World с минимальными ресурсами.
- Сервис был запущен на порту 8080.
- После развертывания был получен публичный URL для тестирования.
- Приложение успешно откликалось на запросы через браузер.

### 2. Тестирование и анализ логов и метрик

- Перешел в раздел "Logs" и **"Metrics" в Google Cloud Console, зафиксировал начальные показатели работы сервиса:

  - **Количество одновременных запросов** (Max concurrent requests) оставалось небольшим (не более 2).
  - **Время отклика** (Request latencies) стабильно находилось на уровне **50-100 мс**.
  - **CPU utilization** — не превышала **1%**.
  - **Memory utilization** — около **18–20%**.
  - **Сетевой трафик** (Sent/Received bytes) показывал всплески в моменты тестирования.
  - **Container startup latency** — около **50-100 мс**.

#### Скриншоты метрик:

- ![Максимальное количество одновременных запросов и время запуска контейнера](screenshots/Image1.png)
- ![Использование CPU, памяти, отправленные и полученные байты](screenshots/Image2.png)
- ![Количество запросов, время ответа, количество экземпляров контейнера и оплачиваемое время работы контейнера](screenshots/Image3.png)

### 3. Изменение порта и тестирование

- Далее сервис был изменен: в настройках был задан порт **8090** вместо стандартного 8080.
- Сервис был пересобран и перезапущен.
- Новый URL был доступен для тестирования — сервис работал корректно на новом порту.

- При сравнении метрик были замечены изменения:
  - При переключении на новую версию активность на старой версии упала.
  - После 22:00 был зафиксирован спад трафика на **50%** на новой версии (порт 8090).
  - Метрики подтвердили уменьшение сетевого трафика и количества запросов.

### 4. Переключение трафика между версиями

- Были протестированы возможности распределения трафика между версиями:
  - При полном переводе трафика на новую версию старый контейнер был остановлен.
  - Метрики и логи показали корректное поведение контейнеров без ошибок.

### 5. Завершение работы

- После проведения всех тестов все созданные сервисы были удалены для предотвращения начисления платы.

## Выводы

- Сервис корректно обрабатывал запросы при работе как на порту **8080**, так и на **8090**.
- Переключение версий сервиса и перераспределение трафика происходило без ошибок и перебоев в работе.
- Метрики показали стабильную работу контейнера с минимальными ресурсами даже при изменениях в конфигурации.
- Работа с Cloud Run показала удобство автоматического масштабирования и управления версиями сервисов.
